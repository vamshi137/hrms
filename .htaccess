# ============================================
# HRMS System - InfinityFree Safe .htaccess
# ✅ Clean + No duplicates
# ✅ Prevent sensitive files access
# ✅ Enables pretty routing but DOES NOT break real files
# ============================================

Options -Indexes
RewriteEngine On

# ------------------------------------------------
# 1) Security: block sensitive files
# ------------------------------------------------
<FilesMatch "\.(ini|log|sh|inc|bak|sql|env|htaccess|htpasswd)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# ------------------------------------------------
# 2) Error Pages
# ⚠️ DO NOT redirect 500 to index.php (causes loops)
# ------------------------------------------------
ErrorDocument 403 /auth/login.php
ErrorDocument 404 /auth/login.php

# ------------------------------------------------
# 3) Front controller
# Only route NON-existing requests to index.php
# This will NOT affect real PHP files like /dashboards/*.php
# ------------------------------------------------
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [L,QSA]

# ------------------------------------------------
# 4) Optional: CORS headers for API calls
# ------------------------------------------------
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type, Authorization"
</IfModule>
